<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<title>Amirxan Temp Mail</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg,#020024,#090979,#00d4ff);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
}
.box {
    background: rgba(0,0,0,0.45);
    padding: 25px;
    border-radius: 15px;
    width: 100%;
    max-width: 430px;
    box-shadow: 0 0 25px rgba(0,255,255,0.4);
}
h1 {
    text-align: center;
    color: #00ffff;
}
.email {
    background: #000;
    padding: 12px;
    border-radius: 10px;
    text-align: center;
    margin-top: 15px;
    word-break: break-all;
    font-weight: bold;
    color: #00ffcc;
}
button {
    width: 100%;
    padding: 12px;
    margin-top: 10px;
    border: none;
    border-radius: 10px;
    font-weight: bold;
    cursor: pointer;
}
.gen { background: #00ffff; }
.chk { background: #00cc99; }
.msgs {
    margin-top: 15px;
    background: #050505;
    padding: 10px;
    border-radius: 10px;
    max-height: 200px;
    overflow-y: auto;
    font-size: 14px;
}
.msg {
    border-bottom: 1px solid #222;
    padding: 6px 0;
}
.footer {
    text-align: center;
    font-size: 12px;
    opacity: 0.7;
    margin-top: 10px;
}
</style>
</head>

<body>

<div class="box">
    <h1>üìß Amirxan Temp Mail</h1>

    <div class="email" id="email">Email yaratilmagan</div>

    <button class="gen" onclick="createMail()">‚ôªÔ∏è Yangi Email</button>
    <button class="chk" onclick="checkInbox()">üì® Xabarlarni Tekshirish</button>

    <div class="msgs" id="msgs">
        <div class="msg">Xabarlar shu yerda chiqadi</div>
    </div>

    <div class="footer">¬© 2026 Amirxan</div>
</div>

<script>
let token = "";
let accountId = "";

function rand(len) {
    return Math.random().toString(36).substring(2, 2 + len);
}

async function createMail() {
    document.getElementById("msgs").innerHTML = "<div class='msg'>Email yaratilmoqda...</div>";

    // domen olish
    let d = await fetch("https://api.mail.tm/domains");
    let dj = await d.json();
    let domain = dj["hydra:member"][0].domain;

    let address = rand(10) + "@" + domain;
    let password = rand(12);

    // account yaratish
    let acc = await fetch("https://api.mail.tm/accounts", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ address, password })
    });

    if (!acc.ok) {
        document.getElementById("msgs").innerHTML = "<div class='msg'>Xatolik! Qayta urinib ko‚Äòring</div>";
        return;
    }

    let accj = await acc.json();
    accountId = accj.id;

    // login
    let lg = await fetch("https://api.mail.tm/token", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ address, password })
    });

    let lgj = await lg.json();
    token = lgj.token;

    document.getElementById("email").innerText = address;
    document.getElementById("msgs").innerHTML = "<div class='msg'>Email tayyor. Xabar kutilyapti...</div>";
}

async function checkInbox() {
    if (!token) {
        alert("Avval email yarating!");
        return;
    }

    let res = await fetch("https://api.mail.tm/messages", {
        headers: { "Authorization": "Bearer " + token }
    });
    let data = await res.json();

    let html = "";
    if (data["hydra:member"].length === 0) {
        html = "<div class='msg'>Hali xabar kelmagan</div>";
    } else {
        data["hydra:member"].forEach(m => {
            html += `<div class="msg">
                <b>Kimdan:</b> ${m.from.address}<br>
                <b>Mavzu:</b> ${m.subject}
            </div>`;
        });
    }
    document.getElementById("msgs").innerHTML = html;
}
</script>

</body>
</html>
